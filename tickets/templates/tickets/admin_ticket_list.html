{% extends "base.html" %}
{% block content %}
<h2>All Reported Issues</h2>

<table class="styled-table">
    <thead>
        <tr>
            <th>ID</th><th>Title</th><th>Resident</th><th>Status</th><th>Assigned To</th><th>Created</th><th>Action</th>
        </tr>
    </thead>
    <tbody>
    {% for ticket in tickets %}
        <tr>
            <td>{{ ticket.id }}</td>
            <td>{{ ticket.issue_title }}</td>
            <td>{{ ticket.resident.user.username }}</td>
            <td>{{ ticket.get_status_display }}</td>
            <td>{% if ticket.assigned_staff %}{{ ticket.assigned_staff.user.username }}{% else %}-{% endif %}</td>
            <td>{{ ticket.created_at|date:"Y-m-d H:i" }}</td>
            <td>
                {% if not ticket.assigned_staff %}
                    <a class="btn" href="{% url 'tickets:assign_ticket' ticket.id %}">Assign</a>
                {% else %}
                    <a class="btn" href="{% url 'tickets:assign_ticket' ticket.id %}">Reassign</a>
                {% endif %}
            </td>
        </tr>
    {% empty %}
        <tr><td colspan="7">No tickets found.</td></tr>
    {% endfor %}
    </tbody>
</table>
{% endblock %}
